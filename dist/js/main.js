"use strict";!function(e){var s,n,i,a,o,t,h={},d=[],r={};function u(t){this.init(t||{})}function c(t){this.init(t||{})}function m(t){document.removeEventListener("mousemove",m),document.removeEventListener("touchstart",m),document.addEventListener("mousemove",y),document.addEventListener("touchmove",y),document.addEventListener("touchstart",x),y(t),f(),p()}function f(){d=[];for(var t=0;t<r.trails;t++)d.push(new c({spring:.45+t/r.trails*.025}))}function p(){if(s.running){s.globalCompositeOperation="source-over",s.fillStyle="rgba(8,5,16,0.4)",s.fillRect(0,0,s.canvas.width,s.canvas.height),s.globalCompositeOperation="lighter",s.strokeStyle="hsla("+Math.round(n.update())+",90%,50%,0.25)",s.lineWidth=1,s.frame%60==0&&console.log(n.update(),Math.round(n.update()),n.phase,n.offset,n.frequency,n.amplitude);for(var t,e=0;e<r.trails;e++)(t=d[e]).update(),t.draw();s.frame++,s.stats.update(),requestAnimFrame(p)}}function g(){s.canvas.width=e.innerWidth,s.canvas.height=e.innerHeight}function v(){s.running||(s.running=!0,p())}function l(){s.running=!1}function y(t){t.touches?(h.x=t.touches[0].pageX,h.y=t.touches[0].pageY):(h.x=t.clientX,h.y=t.clientY),t.preventDefault()}function x(t){1==t.touches.length&&(h.x=t.touches[0].pageX,h.y=t.touches[0].pageY)}function w(t){switch(t.keyCode){case 32:!function(){o||((o=document.createElement("canvas")).width=screen.availWidth,o.height=screen.availHeight,o.ctx=o.getContext("2d"),(a=document.createElement("form")).method="post",a.input=document.createElement("input"),a.input.type="hidden",a.input.name="data",a.appendChild(a.input),document.body.appendChild(a));o.ctx.fillStyle="rgba(8,5,16)",o.ctx.fillRect(0,0,o.width,o.height),o.ctx.drawImage(canvas,Math.round(o.width/2-canvas.width/2),Math.round(o.height/2-canvas.height/2)),o.ctx.drawImage(i,Math.round(o.width/2-i.width/4),Math.round(o.height/2-i.height/4),i.width/2,i.height/2),e.open(o.toDataURL(),"wallpaper","top=0,left=0,width="+o.width+",height="+o.height)}()}}r.debug=!0,r.friction=.5,r.trails=20,r.size=50,r.dampening=.25,r.tension=.98,Math.TWO_PI=2*Math.PI,u.prototype=(t=0,{init:function(t){this.phase=t.phase||0,this.offset=t.offset||0,this.frequency=t.frequency||.001,this.amplitude=t.amplitude||1},update:function(){return this.phase+=this.frequency,t=this.offset+Math.sin(this.phase)*this.amplitude},value:function(){return t}}),c.prototype=function(){function i(){this.x=0,this.y=0,this.vy=0,this.vx=0}return{init:function(t){this.spring=t.spring+.1*Math.random()-.05,this.friction=r.friction+.01*Math.random()-.005,this.nodes=[];for(var e,n=0;n<r.size;n++)(e=new i).x=h.x,e.y=h.y,this.nodes.push(e)},update:function(){var t=this.spring,e=this.nodes[0];e.vx+=(h.x-e.x)*t,e.vy+=(h.y-e.y)*t;for(var n,i=0,a=this.nodes.length;i<a;i++)e=this.nodes[i],0<i&&(n=this.nodes[i-1],e.vx+=(n.x-e.x)*t,e.vy+=(n.y-e.y)*t,e.vx+=n.vx*r.dampening,e.vy+=n.vy*r.dampening),e.vx*=this.friction,e.vy*=this.friction,e.x+=e.vx,e.y+=e.vy,t*=r.tension},draw:function(){var t,e,n=this.nodes[0].x,i=this.nodes[0].y;s.beginPath(),s.moveTo(n,i);for(var a=1,o=this.nodes.length-2;a<o;a++)t=this.nodes[a],e=this.nodes[a+1],n=.5*(t.x+e.x),i=.5*(t.y+e.y),s.quadraticCurveTo(t.x,t.y,n,i);t=this.nodes[a],e=this.nodes[a+1],s.quadraticCurveTo(t.x,t.y,e.x,e.y),s.stroke(),s.closePath()}}}(),e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},e.onload=function(){if((s=document.getElementById("canvas").getContext("2d")).stats=new Stats,s.running=!0,s.frame=1,n=new u({phase:Math.random()*Math.TWO_PI,amplitude:85,frequency:.0015,offset:285}),document.addEventListener("mousemove",m),document.addEventListener("touchstart",m),document.body.addEventListener("orientationchange",g),e.addEventListener("resize",g),e.addEventListener("keyup",w),e.addEventListener("focus",v),e.addEventListener("blur",l),g(),e.DEBUG){new dat.GUI;r.gui.add(r,"trails",1,30).onChange(f),r.gui.add(r,"size",25,75).onFinishChange(f),r.gui.add(r,"friction",.45,.55).onFinishChange(f),r.gui.add(r,"dampening",.01,.4).onFinishChange(f),r.gui.add(r,"tension",.95,.999).onFinishChange(f),document.body.appendChild(s.stats.domElement)}}}(window);